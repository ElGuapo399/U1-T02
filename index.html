<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cargador de JSON</title>
    <style>
body {
    font-family: system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    margin: 2rem;
    background: linear-gradient(180deg, #f6f8fb 0%, #ffffff 100%);
    color: #0f1724;
}
.card {
    max-width: 900px;
    margin: 0 auto;
    background: #ffffff;
    border-radius: 10px;
    box-shadow: 0 6px 18px rgba(15, 23, 36, 0.08);
    padding: 1.5rem;
    border: 1px solid rgba(15,23,36,0.04);
}
h1 { margin-top: 0; }
.lead { color: #475569; margin-top: 0.2rem; }
.controls { display: flex; gap: 0.5rem; align-items: center; margin: 0.6rem 0 1rem 0; }
input[type="file"] { padding: 0.3rem; }
button { background: #0369a1; color: #fff; border: none; padding: 0.5rem 0.9rem; border-radius: 6px; cursor: pointer; }
button:hover { background: #075985; }
button.muted { background: #e2e8f0; color: #0f1724; }
h2 { margin-bottom: 0.3rem; }
.meta { font-size: 0.9rem; color: #475569; margin-bottom: 0.5rem; }
.meta.error { color: #b91c1c; font-weight: 600; }
pre.json {
    padding: 1rem;
    background: #0b1220;
    color: #e6eef8;
    overflow: auto;
    border-radius: 8px;
    line-height: 1.5;
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, 'Roboto Mono', 'Courier New', monospace;
}
.json .key { color: #ffd580; }
.json .string { color: #9ae6b4; }
.json .number { color: #60a5fa; }
.json .boolean { color: #fca5a5; }
.json .null { color: #a3a3a3; }
@media (max-width: 600px) {
    .controls { flex-direction: column; align-items: stretch; }
    button { width: 100%; }
}
    </style>
</head>
<body>
    <div class="card">
        <h1>Cargar archivo JSON</h1>
        <p class="lead">Selecciona un archivo <code>.json</code> para previsualizar su contenido.</p>

        <div class="controls">
            <input id="file" type="file" accept="application/json, .json">
            <button id="show" type="button">Mostrar</button>
            <button id="toggleView" type="button" class="muted">Ver como Tabla</button>
            <button id="clear" type="button" class="muted">Limpiar</button>
        </div>

        <h2>Contenido</h2>
        <div id="meta" aria-live="polite" class="meta">-- aun no hay contenido --</div>
        <div id="views">
            <pre id="out" class="json">{
    "mensage": "Seleccione un archivo JSON y pulse Mostrar"
}</pre>
            <div id="tableView" style="display:none; margin-top:0.6rem; overflow:auto;"></div>
        </div>
    </div>

    <script>
    function syntaxHighlight(json) {
        if (typeof json != 'string') {
            json = JSON.stringify(json, undefined, 2);
        }
        json = json.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
        return json.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g, function (match) {
            var cls = 'number';
            if (/^"/.test(match)) {
                if (/:$/.test(match)) {
                    cls = 'key';
                } else {
                    cls = 'string';
                }
            } else if (/true|false/.test(match)) {
                cls = 'boolean';
            } else if (/null/.test(match)) {
                cls = 'null';
            }
            return '<span class="' + cls + '">' + match + '</span>';
        });
    }
    const fileInput = document.getElementById('file');
    const showBtn = document.getElementById('show');
    const clearBtn = document.getElementById('clear');
    const out = document.getElementById('out');
    const meta = document.getElementById('meta');
    const toggleBtn = document.getElementById('toggleView');
    const tableView = document.getElementById('tableView');
    function showError(msg) {
        meta.textContent = msg;
        meta.classList.add('error');
    }
    function clearOutput() {
        out.innerHTML = '{\n    "message": "Seleccione un archivo JSON y pulse Mostrar"\n}';
        meta.textContent = '-- aun no hay contenido --';
        meta.classList.remove('error');
        tableView.innerHTML = '';
        tableView.style.display = 'none';
        out.style.display = '';
        toggleBtn.textContent = 'Ver como Tabla';
    }
    showBtn.addEventListener('click', () => {
        meta.classList.remove('error');
        const file = fileInput.files && fileInput.files[0];
        if (!file) {
            showError('No hay archivo seleccionado.');
            return;
        }
        if (!file.name.toLowerCase().endsWith('.json')) {
            showError('Por favor seleccione un archivo con extensión .json');
            return;
        }
        const reader = new FileReader();
        reader.onload = (e) => {
            const text = e.target.result;
            try {
                const data = JSON.parse(text);
                out.innerHTML = syntaxHighlight(data);
                meta.textContent = `Archivo: ${file.name} — ${file.size} bytes`;
                renderTableView(data);
            } catch (err) {
                showError('Error al parsear JSON: ' + err.message);
                out.textContent = text;
            }
        };
        reader.onerror = () => showError('Error leyendo el archivo');
        reader.readAsText(file, 'UTF-8');
    });
    clearBtn.addEventListener('click', clearOutput);
    clearOutput();
    toggleBtn.addEventListener('click', () => {
        if (tableView.innerHTML.trim() === '') return;
        if (tableView.style.display === 'none') {
            tableView.style.display = '';
            out.style.display = 'none';
            toggleBtn.textContent = 'Ver como JSON';
        } else {
            tableView.style.display = 'none';
            out.style.display = '';
            toggleBtn.textContent = 'Ver como Tabla';
        }
    });
    function renderTableView(data) {
        tableView.innerHTML = '';
        if (Array.isArray(data) && data.length > 0 && data.every(item => typeof item === 'object' && !Array.isArray(item))) {
            tableView.appendChild(createTableFromArray(data));
            return;
        }
        if (typeof data === 'object' && data !== null) {
            const arrays = Object.entries(data).filter(([k,v]) => Array.isArray(v) && v.length>0 && v.every(it=>typeof it==='object'));
            if (arrays.length === 1 && Object.keys(data).length === 1) {
                tableView.appendChild(createTableFromArray(arrays[0][1]));
                return;
            }
            const table = document.createElement('table');
            table.style.width = '100%';
            table.style.borderCollapse = 'collapse';
            table.style.marginTop = '0.5rem';
            const tbody = document.createElement('tbody');
            for (const [key, value] of Object.entries(data)) {
                const tr = document.createElement('tr');
                const tdKey = document.createElement('td');
                tdKey.textContent = key;
                tdKey.style.fontWeight = '600';
                tdKey.style.padding = '8px';
                tdKey.style.border = '1px solid #e6eef8';
                const tdVal = document.createElement('td');
                tdVal.style.padding = '8px';
                tdVal.style.border = '1px solid #e6eef8';
                if (typeof value === 'object' && value !== null) {
                    const nested = document.createElement('pre');
                    nested.className = 'json';
                    nested.style.margin = '0';
                    nested.textContent = JSON.stringify(value, null, 2);
                    tdVal.appendChild(nested);
                } else {
                    tdVal.textContent = String(value);
                }
                tr.appendChild(tdKey);
                tr.appendChild(tdVal);
                tbody.appendChild(tr);
            }
            table.appendChild(tbody);
            tableView.appendChild(table);
            return;
        }
        const pre = document.createElement('pre');
        pre.className = 'json';
        pre.textContent = JSON.stringify(data, null, 2);
        tableView.appendChild(pre);
    }
    function createTableFromArray(arr) {
    if (!Array.isArray(arr) || arr.length === 0) {
        const errorMsg = document.createElement('div');
        errorMsg.textContent = 'No hay datos válidos para mostrar en tabla';
        errorMsg.style.color = '#b91c1c';
        return errorMsg;
    }

    const columns = new Set();
    
    arr.forEach(item => {
        if (item && typeof item === 'object' && !Array.isArray(item)) {
            Object.keys(item).forEach(k => columns.add(k));
        }
    });
    
    const cols = Array.from(columns);
    
    if (cols.length === 0) {
        const msg = document.createElement('div');
        msg.textContent = 'No se encontraron columnas válidas';
        return msg;
    }

    const table = document.createElement('table');
    table.style.width = '100%';
    table.style.borderCollapse = 'collapse';
    table.style.marginTop = '0.5rem';
    table.style.fontSize = '0.9em';
    table.style.fontFamily = 'inherit';

    const thead = document.createElement('thead');
    const headRow = document.createElement('tr');
    cols.forEach(c => {
        const th = document.createElement('th');
        th.textContent = c;
        th.style.textAlign = 'left';
        th.style.padding = '10px 8px';
        th.style.border = '1px solid #d1d5db';
        th.style.background = '#f3f4f6';
        th.style.fontWeight = '600';
        th.style.fontSize = '0.85em';
        headRow.appendChild(th);
    });
    thead.appendChild(headRow);
    table.appendChild(thead);

    const tbody = document.createElement('tbody');
    arr.forEach((item, index) => {

        if (!item || typeof item !== 'object' || Array.isArray(item)) {
            return;
        }

        const tr = document.createElement('tr');
        tr.style.backgroundColor = index % 2 === 0 ? '#ffffff' : '#f9fafb';
        
        cols.forEach(col => {
            const td = document.createElement('td');
            td.style.padding = '10px 8px';
            td.style.border = '1px solid #e5e7eb';
            td.style.verticalAlign = 'top';
            td.style.fontSize = '0.85em';
            td.style.lineHeight = '1.4';
            
            let val = '';
            if (item && Object.prototype.hasOwnProperty.call(item, col)) {
                val = item[col];
            }
            
            if (val === null || val === undefined) {
                td.textContent = '-';
                td.style.color = '#9ca3af';
                td.style.fontStyle = 'italic';
            } else if (Array.isArray(val)) {

                if (val.length === 0) {
                    td.textContent = '[]';
                    td.style.color = '#9ca3af';
                } else {
                    td.textContent = val.join(', ');
                    td.style.color = '#059669';
                }
            } else if (typeof val === 'object') {

                try {
                    const objStr = JSON.stringify(val, null, 2)
                        .replace(/[{}",]/g, ' ')
                        .replace(/\s+/g, ' ')
                        .trim();
                    td.textContent = objStr || '{}';
                    td.style.color = '#7c3aed';
                    td.style.fontFamily = 'ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace';
                    td.style.fontSize = '0.8em';
                } catch (e) {
                    td.textContent = '[Object]';
                }
            } else if (typeof val === 'boolean') {
                td.textContent = val ? '✓ Sí' : '✗ No';
                td.style.color = val ? '#059669' : '#dc2626';
                td.style.fontWeight = '500';
            } else if (typeof val === 'number') {
                td.textContent = val.toString();
                td.style.color = '#0369a1';
                td.style.textAlign = 'right';
                td.style.fontFamily = 'ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace';
            } else {

                td.textContent = String(val);
                td.style.color = '#1f2937';
            }
            
            tr.appendChild(td);
        });
        tbody.appendChild(tr);
    });
    table.appendChild(tbody);
    
    return table;
}

    </script>
</body>
</html>